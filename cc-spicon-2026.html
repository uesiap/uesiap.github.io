<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Central Circar Spicon 2026 Registration Form</title>
    <meta property="og:title" content="Central Circar Spicon 2026 Registration Form" />
    <meta property="og:description" content="Register for the Central Circar Spicon 2026 through this link." />
    <meta property="og:image" content="https://uesiap.github.io/assets/cc-spicon-2026-banner.png" />
    <link rel="shortcut icon" type="image/x-icon"
        href="https://www.uesitn.org/wp-content/uploads/2020/08/uesi-favicon.png">
    <link rel="apple-touch-icon" href="https://uesiap.github.io/vidhyardhi-geethavali/Icon192.jpg">
    <meta property="og:url" content="https://uesiap.github.io/cc-spicon-2026" />
    <meta property="og:type" content="form" />
    <meta property="og:site_name" content="UESI AP" />
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    <script>
        (async () => {
            if ('caches' in window) {
                const keys = await caches.keys();
                for (const key of keys) await caches.delete(key);
            }
            localStorage.clear();
            sessionStorage.clear();
        })();
    </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        :root {
            --brand: #673AB7;
            --brand-dark: #38117c;
            --muted: #6b7280;
            --line: #a1b0cf;
            --bg: #F0EBF8;
            --progress: 0%;
            --anim: 1000ms;
        }

        * {
            box-sizing: border-box;
            font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            margin: 0;
            background: var(--bg);
            color: #111827;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* HEADER */
        header {
            background: var(--brand);
            color: #fff;
            padding: 3px 3px;
            display: flex;
            flex-direction: column;
            align-items: center;
            border-bottom: 4px solid var(--brand-dark);
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 1000;
            overflow: hidden;
        }

        header h1 {
            font-size: 2rem;
            font-weight: 800;
            margin: 8px;
            letter-spacing: -0.5px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        /* MAIN CONTAINER */
        .main {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            width: 100%;
            margin: 0 auto;
            padding: 13px;
            padding-top: 80px;
        }

        .progress-wrap {
            width: 100vw;
            background-color: var(--bg);
            max-width: none;
            margin: 0;
            position: fixed;
            top: 60px;
            left: 0;
            padding-top: 18px;
            z-index: 999;
            padding-bottom: 10px;
            border-bottom: 1.5px solid var(--brand);
        }

        .progress-line {
            position: absolute;
            left: 17%;
            right: 17%;
            top: 38px;
            height: 3px;
            background: var(--line);
            overflow: hidden;
        }

        .progress-line::after {
            content: "";
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: var(--progress);
            background: linear-gradient(90deg, var(--brand), var(--brand));
            transition: width var(--anim) ease;
        }

        .steps {
            display: flex;
            justify-content: space-between;
            z-index: 1;
            position: relative;
        }

        .step {
            text-align: center;
            flex: 1;
            cursor: pointer;
            user-select: none;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
            transition: transform 0.15s ease;
        }

        .step:active {
            transform: scale(0.97)
        }

        .step .num {
            width: 38px;
            height: 38px;
            border: 2px solid #9ca3af;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--muted);
            background: #fff;
            font-weight: 700;
            transition: all var(--anim) ease;
            border-radius: 50%;
        }

        .step .label {
            font-size: 0.8rem;
            color: var(--muted);
            transition: color var(--anim);
            font-weight: 500;
        }

        .step.active .num {
            border-color: var(--brand);
            color: var(--brand);
        }

        .step.active .label {
            color: var(--brand);
            font-weight: 600;
        }

        .step.pressed .num {
            background: var(--brand);
            color: #fff;
            border-color: transparent;
        }

        /* FORM CONTAINER */
        .form-container {
            background: #fff;
            margin-top: 5rem;
            width: 100%;
            max-width: 680px;
            min-height: auto;
            padding: 10px 10px;
            border: 1px solid var(--brand-dark);
            display: none;
            flex-direction: column;
            justify-content: space-between;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.06);
            border-radius: 0;
            transition: opacity var(--anim) ease, transform var(--anim) ease;
        }

        .form-container.show {
            display: flex;
        }

        .form-containerr {
            background: #fff;
            width: 100%;
            max-width: 680px;
            min-height: auto;
            padding: 10px 10px;
            border: 1px solid var(--brand);
            display: none;
        }

        form,
        .intro {
            display: none;
            opacity: 0;
            transform: translateY(8px);
            transition: opacity var(--anim), transform var(--anim);
        }

        form.active,
        .intro.active {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }

        h2 {
            margin-bottom: 20px;
            font-size: 1.5rem;
            color: var(--brand-dark);
            font-weight: 700;
        }

        /* INPUTS */
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #0f172a;
            font-size: 0.95rem;
        }

        label .required {
            color: #dc2626;
            margin-left: 2px;
        }

        input,
        select {
            width: 100%;
            padding: 11px 14px;
            border: 1.5px solid #cbd5e1;
            background: #fff;
            font-size: 1.2rem;
            margin-bottom: 18px;
            outline: none;
            transition: all 180ms;
            border-radius: 0;
        }

        input:focus,
        select:focus {
            border-color: var(--brand);
            box-shadow: 0 0 0 3px rgba(124, 58, 237, 0.1);
        }

        /* INFO BOX */
        .info-box {
            background: #fff;
            border: 1.5px solid #f59e0b;
            border-left: 5px solid #f59e0b;
            padding: 18px 10px;
            margin-bottom: 20px;
            border-radius: 0;
        }

        .info-box strong {
            color: #92400e;
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 10px;
            font-size: 1.05rem;
        }

        .info-box p {
            margin: 0;
            color: #78350f;
            font-size: 0.95rem;
            line-height: 1.6;
        }

        /* FEE DISPLAY */
        .fee-display {
            background: #f0fdf4;
            border: 2px solid #86efac;
            padding: 16px 20px;
            margin: 16px 0 24px;
            border-radius: 0;
            text-align: center;
        }

        .fee-display .label {
            font-size: 0.9rem;
            color: #166534;
            margin-bottom: 6px;
            font-weight: 600;
        }

        .fee-display .amount {
            font-size: 2rem;
            color: #15803d;
            font-weight: 800;
        }

        /* CONDITIONAL SECTIONS */
        .conditional-fields {
            display: none;
            padding: 16px;
            background: #f9fafb;
            border-radius: 0;
            margin-bottom: 16px;
        }

        .conditional-fields.show {
            display: block;
        }

        /* NAVIGATION & BUTTONS */
        .nav-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
        }

        .btnn {
            border: 2px solid var(--brand);
            background: #fff;
            color: var(--brand);
            padding: 12px 28px;
            font-size: 1rem;
            cursor: pointer;
            transition: all var(--anim);
            border-radius: 0;
            font-weight: 600;
            box-shadow: none;
            -webkit-tap-highlight-color: rgba(0, 153, 255, 0.2);
        }

        .btnn:hover {
            background: #faf5ff;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(124, 58, 237, 0.15);
        }

        .btnn:active {
            transform: translateY(0);
        }

        .btn-right {
            display: flex;
            justify-content: center;
            width: 100%;
        }

        /* ICON BUTTONS */
        .icon-btn {
            border: 2px solid var(--brand);
            background: #fff;
            color: var(--brand);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 10px 16px;
            transition: all 0.2s;
            border-radius: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            -webkit-tap-highlight-color: rgba(0, 153, 255, 0.2);
        }

        .icon-btn:hover {
            background: #faf5ff;
            color: var(--brand-dark);
        }

        .icon-btn:active {
            transform: scale(0.92);
        }

        .icon-btn[disabled] {
            opacity: 0.4;
            pointer-events: none;
        }

        /* INTRO SECTION */
        .intro {
            max-width: 780px;
            text-align: left;
        }

        .intro h2 {
            color: var(--brand-dark);
        }

        .intro .btn {
            margin-top: 20px;
            display: inline-block;
        }

        /* PAYMENT BUTTONS */
        .pay-methods {
            display: flex;
            gap: 12px;
            margin: 20px 0;
            justify-content: center;
            flex-wrap: wrap;
        }

        .pay-btn {
            flex: 0 0 auto;
            border: 2px solid #e5e7eb;
            background: #fff;
            cursor: pointer;
            transition: all 0.2s;
            padding: 12px;
            border-radius: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .pay-btn img {
            height: 36px;
            width: auto;
        }

        .pay-btn:hover {
            border-color: var(--brand);
            background: #faf5ff;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(124, 58, 237, 0.15);
        }

        .pay-btn:active {
            transform: translateY(0);
        }

        /* COPY BUTTON */
        .copy-btn {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 8px 14px;
            border: 1.5px solid var(--brand);
            background: #fff;
            color: var(--brand);
            border-radius: 0;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            margin-left: 8px;
        }

        .copy-btn:hover {
            background: var(--brand);
            color: #fff;
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(124, 58, 237, 0.25);
        }

        .copy-btn:active {
            transform: translateY(0);
        }

        /* INSTRUCTION SECTION */
        .instruction-section {
            background: #f9fafb;
            border: 1px solid #e5e7eb;
            padding: 20px;
            border-radius: 0;
            margin-bottom: 20px;
        }

        .instruction-section h3 {
            color: var(--brand-dark);
            font-size: 1.15rem;
            margin: 0 0 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .instruction-section ul {
            margin: 0;
            padding-left: 24px;
        }

        .instruction-section li {
            color: #374151;
            line-height: 1.7;
            margin-bottom: 10px;
        }

        /* FEE TABLE */
        .fee-table {
            background: #fff;
            border: 1px solid #e5e7eb;
            border-radius: 0;
            margin: 16px 0;
            overflow: hidden;
        }

        .fee-table table {
            width: 100%;
            border-collapse: collapse;
        }

        .fee-table th {
            background: var(--brand);
            color: #fff;
            padding: 12px;
            text-align: left;
            font-weight: 600;
        }

        .fee-table td {
            padding: 10px 12px;
            border-top: 1px solid #e5e7eb;
        }

        .fee-table tr {
            border-bottom: 1.5px solid var(--brand-dark);
        }

        .fee-table tr:hover {
            background: var(--bg);
        }

        /* Background overlay */
        .dialog-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        /* Dialog box */
        .dialog-box {
            background: white;
            padding: 20px 25px;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            max-width: 300px;
            text-align: center;
            font-family: Arial, sans-serif;
        }

        .dialog-box h3 {
            margin-top: 0;
            color: #333;
        }

        .dialog-box p {
            margin: 10px 0;
        }

        .dialog-button {
            background: #007bff;
            color: white;
            border: none;
            border-radius: 6px;
            padding: 8px 14px;
            margin-top: 10px;
            cursor: pointer;
        }

        .dialog-button:hover {
            background: #0056b3;
        }

        footer {
            padding-top: 15px;
            padding-bottom: 15px;
            text-align: center;
            color: black;
            font-size: 1rem;
            font-weight: 400;
            border-top: 2px solid var(--brand);
            background-color: transparent;
        }

        #qrPreviewModal {
            backdrop-filter: blur(3px);
        }

        #qrPreviewImage {
            transition: transform 0.3s ease;
        }

        #qrPreviewImage:hover {
            transform: scale(1.03);
        }

        /* LOADER OVERLAY */
        #loaderContainer {
            display: none;
            position: fixed;
            inset: 0;
            background-color: rgba(0, 0, 0, 0.55);
            z-index: 9999;
        }

        #loader {
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            color: #fff;
        }

        #loader p {
            margin-top: 16px;
            font-size: 1.4rem;
            letter-spacing: 0.5px;
        }

        .spinner {
            display: inline-block;
            position: relative;
            width: 80px;
            height: 80px;
        }

        .spinner div {
            transform-origin: 40px 40px;
            animation: spinner 1.2s linear infinite;
        }

        .spinner div:after {
            content: "";
            display: block;
            position: absolute;
            top: 3px;
            left: 37px;
            width: 6px;
            height: 18px;
            border-radius: 20%;
            background: #ffffff;
        }

        .spinner div:nth-child(1) {
            transform: rotate(0deg);
            animation-delay: -1.1s;
        }

        .spinner div:nth-child(2) {
            transform: rotate(30deg);
            animation-delay: -1s;
        }

        .spinner div:nth-child(3) {
            transform: rotate(60deg);
            animation-delay: -0.9s;
        }

        .spinner div:nth-child(4) {
            transform: rotate(90deg);
            animation-delay: -0.8s;
        }

        .spinner div:nth-child(5) {
            transform: rotate(120deg);
            animation-delay: -0.7s;
        }

        .spinner div:nth-child(6) {
            transform: rotate(150deg);
            animation-delay: -0.6s;
        }

        .spinner div:nth-child(7) {
            transform: rotate(180deg);
            animation-delay: -0.5s;
        }

        .spinner div:nth-child(8) {
            transform: rotate(210deg);
            animation-delay: -0.4s;
        }

        .spinner div:nth-child(9) {
            transform: rotate(240deg);
            animation-delay: -0.3s;
        }

        .spinner div:nth-child(10) {
            transform: rotate(270deg);
            animation-delay: -0.2s;
        }

        .spinner div:nth-child(11) {
            transform: rotate(300deg);
            animation-delay: -0.1s;
        }

        .spinner div:nth-child(12) {
            transform: rotate(330deg);
            animation-delay: 0s;
        }

        @keyframes spinner {
            0% {
                opacity: 1;
            }

            100% {
                opacity: 0;
            }
        }

        .success-message-container {
            padding: 25px 20px;
            text-align: center;
            position: relative;
            overflow: hidden;
            display: none;
            animation: fadeIn 0.8s ease-out forwards;
        }

        /* Animated tick */
        .success-icon {
            width: 100px;
            height: 100px;
            stroke-width: 7;
            stroke: #4caf50;
            fill: none;
            stroke-linecap: round;
            margin-bottom: 15px;
            animation: scaleUp 0.5s ease forwards;
        }

        .success-icon circle {
            stroke-dasharray: 283;
            stroke-dashoffset: 283;
            animation: drawCircle 1.1s ease forwards;
        }

        .success-icon path {
            stroke-dasharray: 100;
            stroke-dashoffset: 100;
            animation: drawCheck 1s 1s ease forwards;
        }

        .success-message-container h1 {
            color: #2e7d32;
            font-weight: 500;
            margin-bottom: 6px;
            font-size: 1.3rem;
        }

        .success-message-container p {
            color: #555;
            margin: 0;
            font-size: 0.95rem;
        }

        .scuuess-wa-btn {
            cursor: pointer;
            transition: all var(--anim);
            box-shadow: none;
            -webkit-tap-highlight-color: rgba(0, 153, 255, 0.2);
        }

        .success-wa-btn:hover {
            background: #faf5ff;
            color: var(--brand-dark);
        }

        /* Animations */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes scaleUp {
            0% {
                transform: scale(0);
                opacity: 0;
            }

            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        @keyframes drawCircle {
            to {
                stroke-dashoffset: 0;
            }
        }

        @keyframes drawCheck {
            to {
                stroke-dashoffset: 0;
            }
        }

        /* Responsive */
        @media (max-width: 600px) {
            .success-message-container {
                padding: 20px 15px;
            }

            .success-message-container h3 {
                font-size: 1rem;
            }

            .success-icon {
                width: 60px;
                height: 60px;
            }
        }

        /* CONFIRMATION MODAL */
        #confirmDialog .modal-content {
            border-radius: 10px;
            border: none;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        #confirmDialog .modal-header {
            background-color: #f8f9fa;
            border-bottom: 1px solid #ddd;
        }

        #confirmDialog .modal-title {
            color: #333;
            font-weight: 600;
        }

        #confirmDialog .modal-body {
            color: #444;
            font-size: 1rem;
        }

        #confirmDialog .btn-primary {
            background-color: #197afe;
            border: none;
        }

        #confirmDialog .btn-primary:hover {
            background-color: #0056b3;
        }

        @media(max-width:640px) {
            .form-container {
                padding: 28px 20px;
            }

            .spinner {
                width: 60px;
                height: 60px;
            }

            #loader p {
                font-size: 1rem;
            }

            .success-icon {
                width: 70px;
                height: 70px;
            }

            .success-container {
                padding: 20px 15px;
            }

            .success-container h1 {
                font-size: 1.2rem;
            }

            .success-container p {
                font-size: 0.9rem;
            }
        }

        .error-field {
            border: 1.5px solid red !important;
            animation: shake 0.6s ease-in-out 0s 2;
        }

        @keyframes shake {
            0% {
                transform: translateX(0);
            }

            25% {
                transform: translateX(-4px);
            }

            50% {
                transform: translateX(4px);
            }

            75% {
                transform: translateX(-4px);
            }

            100% {
                transform: translateX(0);
            }
        }

        .head_img {
            border-radius: 50%;
        }

        header span {
            display: flex;
            align-items: center;
            /* keeps image + text nicely aligned */
            gap: 0.5rem;
            /* optional: space between image and text */
        }
    </style>
</head>

<body>
    <header>
        <span>
            <img class="head_img"
                src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQcSxSNUXpJ8n2YkTuBEeO84gb1dH6NRhvQNg&s"
                width="40" height="40" alt="Logo">
            <h1>SPICON 2026</h1>
        </span>
    </header>

    <div id="customDialog" class="dialog-overlay">
        <div class="dialog-box">
            <h3 id="dialogTitle"></h3>
            <p id="dialogMessage"></p>
            <button class="dialog-button" onclick="closeDialog()">OK</button>
        </div>
    </div>

    <div id="customDialogg" class="dialog-overlay" style="display: none;">
        <div class="dialog-box">
            <h3 id="dialogTitlee"></h3>
            <p id="dialogMessagee"></p>
            <button id="dialogOkButton" class="dialog-button">OK</button>
        </div>
    </div>

    <!-- QR Preview Modal -->
    <div id="qrPreviewModal" class="dialog-overlay" style="display:none;">
        <div class="dialog-box" style="max-width:400px;padding:10px;background:#fff;border-radius:8px;">
            <img id="qrPreviewImage" src="" alt="QR Code Preview"
                style="width:100%;height:auto;border:2px solid var(--brand);border-radius:8px;">
            <button class="dialog-button" style="margin-top:12px;" onclick="closeQRPreview()">Close</button>
        </div>
    </div>

    <div id="waQRModal" class="dialog-overlay" style="display:none;">
        <div class="dialog-box" style="max-width:400px;padding:10px;background:#fff;border-radius:8px;">
            <img id="waQRCodeImage" src="" alt="WA QR Code Preview"
                style="width:100%;height:auto;border:2px solid var(--brand);border-radius:8px;">
            <button class="dialog-button" style="margin-top:12px;" onclick="closeWAQR()">Close</button>
        </div>
    </div>

    <main class="main" id="main-show-section">
        <section class="intro active" id="intro" style="margin-top: 1rem;">
            <h2 style="font-size: 1.2rem; color: #A932BC; text-align: center;">Central Circar Region</h2>
            <hr>
            <h2 id="heaf">üìã Welcome to Registration Form</h2>
            <h2 id="headf" style="display: none;">üìã Registration Form Closed</h2>

            <div class="instruction-section" style="background-color: #fff; border: 1.5px solid var(--brand)">
                <span style="display: flex;"><span>üèïÔ∏è</span>&nbsp;<h3 style="text-decoration: underline">Program
                        Details</h3>
                </span>
                <p style="margin:0;color:#374151;line-height:1.7">
                    <strong>üìÖ Dates:</strong> 12th (4 PM) - 15th (2 PM) Jan 2026<br>
                    <strong>üìå Venue:</strong> Priyadarshini Engg College, Guntur
                </p>
            </div>

            <div class="instruction-section" style="background-color: #fff; border: 1.5px solid var(--brand)">
                <span style="display: flex;">
                    <h3 style="text-decoration: underline">Speakers</h3>&nbsp;<span>üé§</span>
                </span>
                <p style="margin:0;color:#374151;line-height:1.7">
                    <strong>Devotions: <span style="color: #D05C14;">Mr. K. Yohan, Tuni</span></strong><br>
                    <strong>Expositions: <span style="color: #A932BC;">Mr. R. Billy, Salem</span></strong><br>
                    <strong>Keynote: <span style="color: #004AAD;">Mr. G. J. Roy, Ongole</span></strong>
                </p>
            </div>

            <div class="info-box">
                <strong id="eligibulity">‚úÖ ELIGIBILITY: Believeing Students & Graduates of UESI</strong>
                <p><strong>üìÖ Last Day for Registration:</strong> 27th DEC 2025</p>
            </div>

            <div class="fee-table" id="close-category" style="background-color: #fff; border: 1.5px solid var(--brand)">
                <table>
                    <tr>
                        <th>üìä Category</th>
                        <th>üíµ Reg Fee</th>
                    </tr>
                    <tr>
                        <td>üë®‚Äçüéì Students</td>
                        <td>‚Çπ 700</td>
                    </tr>
                    <tr>
                        <td>üë®‚Äçüéì Single Unemployed Graduate</td>
                        <td>‚Çπ 800</td>
                    </tr>
                    <tr>
                        <td>üë§ Single Employed Graduate</td>
                        <td>‚Çπ 1600</td>
                    </tr>
                    <tr>
                        <td>üë∂ Children (12 - 15 Yrs)</td>
                        <td>‚Çπ 500 (per child)</td>
                    </tr>
                    <tr>
                        <td>üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Family</td>
                        <td>‚Çπ 2600</td>
                    </tr>
                    <!-- <tr>
            <td>üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Both Employed Family</td>
            <td>‚Çπ3000</td>
          </tr>
          <tr>
            <td>üëî Staff</td>
            <td>‚Çπ 0</td>
          </tr>-->
                    <!--<tr>
            <td>üéµ Choir Member</td>
            <td>to be update</td>
          </tr>
          <tr>
            <td>ü§ù Volunteer</td>
            <td>‚Çπ 100</td>
          </tr>-->
                </table>
            </div>

            <span id="open-registrer-info">
                <div class="instruction-section" style="background-color: #fff; border: 1.5px solid var(--brand)">
                    <h3 style="text-decoration: underline">Payment Information</h3>
                    <p style="margin:0;color:#374151;line-height:1.7">
                        <span style="color: red;">Must Transfer 50% of your registration fee to:</span><br>
                        <strong>üì± Phone Number:</strong> 8341545549<br>
                        <strong>üë§ Name:</strong> DOKKA CHANDU BABU<br>
                        <strong>üí≥ Accepted:</strong> Google Pay / PhonePe
                    </p>
                </div>
                <br>
                <div class="btn-right" style="margin-top: 1rem;">
                    <button class="btnn" onclick="pressThenStart(this)">Start Registration &nbsp;<i
                            class="fa-solid fa-arrow-up-right-from-square"></i></button>
                </div>
            </span>
            <span id="closed-registrer-info" style="display: none;">
                <div class="instruction-section" id="closed-regitrer-info"
                    style="background-color: #fff; border: 1.5px solid var(--brand);">
                    <h3 style="text-decoration: underline">For further Details</h3>
                    <h3 style="text-decoration: none">Please Contact Spicon Registrers</h3>
                    <strong><span style="color: #D05C14;">Person 1</span></strong><br>
                    <p style="margin:0;color:#374151;line-height:1.7">
                        <strong>üì± Phone Number:</strong> 9866819908<br>
                        <strong>üë§ Name:</strong> CHINNAM SYAM BABU<br>
                    </p>
                    <strong><span style="color: #A932BC;">Person 2</span></strong><br>
                    <p style="margin:0;color:#374151;line-height:1.7">
                        <strong>üì± Phone Number:</strong> 8341545549<br>
                        <strong>üë§ Name:</strong> DOKKA CHANDU BABU<br>
                    </p>
                </div>

                <br>
                <div class="btn-right" style="margin-top: 1rem;">
                    <button class="btnn" onclick="window.open('https://wa.me/919866819908','_blank')">
                        Contact Registrar &nbsp;
                        <i class="fa-solid fa-arrow-up-right-from-square"></i>
                    </button>
                </div>
            </span>

            <br>
        </section>

        <div id="progressWrap" class="progress-wrap" style="display:none">
            <div class="progress-line"></div>
            <div class="steps">
                <div class="step active" onclick="pressThenGo(this,0)">
                    <div class="num">1</div>
                    <div class="label">Personal</div>
                </div>
                <div class="step" onclick="pressThenGo(this,1)">
                    <div class="num">2</div>
                    <div class="label">Location</div>
                </div>
                <div class="step" onclick="pressThenGo(this,2)">
                    <div class="num">3</div>
                    <div class="label">Payment</div>
                </div>
            </div>
        </div>

        <div class="form-container" style="margin-top: 6rem; margin-bottom: auto;">
            <span id="steps-container">
                <!-- Step 1 -->
                <form id="step1">
                    <div>
                        <h2>Personal Details <span style="color: var(--brand);">üë§</span></h2>

                        <label>Full Name<span class="required">*</span></label>
                        <input type="text" id="fullName" pattern="[A-Za-z.\s]{2,}" placeholder="Enter your full name"
                            required />

                        <label>Contact Number<span class="required">*</span></label>
                        <input type="tel" id="contact" pattern="[0-9]{10}" placeholder="Enter phone number" required />

                        <label>Gender<span class="required">*</span></label>
                        <select id="gender" required>
                            <option value="" disabled selected>Select Gender</option>
                            <option value="Male">üßî‚Äç‚ôÇÔ∏è Male</option>
                            <option value="Female">üë© Female</option>
                        </select>

                        <label>I would like to attend as a/an<span class="required">*</span></label>
                        <select id="attendAs" required onchange="updateAttendeeType()">
                            <option value="" disabled selected>Select Category</option>
                            <option value="Student">üë®‚Äçüéì Student</option>
                            <option value="Single Unemployed">üéì Single Unemployed Graduate</option>
                            <option value="Single Employed">üë§ Single Employed Graduate</option>
                            <option value="Family">üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Family</option>
                            <!-- <option value="Both Employed Family">üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Both Employed Family</option> -->
                            <!--<option value="Staff">üëî Staff</option>-->
                            <!-- <option value="Choir">üéµ Choir Member</option> -->
                            <!--<option value="Volunteer">ü§ù Volunteer</option>-->
                            <!-- <option value="Other">üìù Other (specify)</option> -->
                        </select>
                        <span id="Volunteer"></span>
                        <span id="Staff"></span>

                        <div id="otherSpecify" style="display:none">
                            <label>Please Specify<span class="required">*</span></label>
                            <input type="text" id="otherText" placeholder="Specify your category" />
                        </div>

                        <div id="familyFields" class="conditional-fields">
                            <label>Spouse Name<span class="required">*</span></label>
                            <input type="text" id="spouseName" pattern="[A-Za-z.\s]{2,}"
                                placeholder="Enter spouse name" />

                            <!-- <label>Name & Age of Children (12 - 15 Years)<span class="required">*</span></label>
              <input type="text" id="children" placeholder="0" value="0" /> -->
                            <label>Select no. of children attending (Beolow 12 Years)<span
                                    class="required">*</span></label>
                            <select id="kiddosCount" required>
                                <option value="0" selected>0</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                            </select>

                            <label>Select no. of children attending (12‚Äì15 Years)</label>
                            <select id="childrenCount">
                                <option value="0">0</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                            </select>

                            <div id="childrenFields"></div>

                        </div>

                        <label>Recommended By (Name)<span class="required">*</span></label>
                        <input type="text" id="recommendName" pattern="[A-Za-z.\s]{2,}"
                            placeholder="Name of recommender" required />

                        <label>Recommended By (Role)<span class="required">*</span></label>
                        <select id="recommendRole" required>
                            <option value="" disabled selected>Select Role</option>
                            <option>Senior Advisor</option>
                            <option>EGF Secretary / EGF President</option>
                            <option>DC / RC / Chairman</option>
                            <option>Staff</option>
                        </select>

                        <label>Contact Number (One Who Recommended)<span class="required">*</span></label>
                        <input type="tel" id="recommendContact" pattern="[0-9]{10}" placeholder="Enter phone number"
                            required />
                    </div>
                    <div class="nav-row">
                        <button type="button" class="icon-btn" onclick="backToIntro()">
                            <i class="fa-solid fa-arrow-left"></i>
                        </button>
                        <button type="button" class="icon-btn" onclick="pressThenNext(this,1)">
                            <i class="fa-solid fa-arrow-right"></i>
                        </button>
                    </div>
                </form>

                <form id="step2">
                    <div>
                        <h2>Location Details üìç</h2>

                        <label>District<span class="required">*</span></label>
                        <select id="district" required onchange="updatePlaces()">
                            <option value="" disabled selected>Select District</option>
                            <option value="NTR">N.T.R District</option>
                            <option value="Guntur">Guntur</option>
                            <option value="Palnadu">Palnadu</option>
                            <option value="Other District">Other District</option>
                        </select>

                        <!-- Hidden input for custom district -->
                        <div id="otherDistrictContainer" style="display:none; margin-top:10px;">
                            <label>Enter the Other District:<span class="required">*</span></label>
                            <input type="text" id="otherDistrictInput" placeholder="Enter your district name here" />
                        </div>

                        <label>Place<span class="required">*</span></label>
                        <select id="place" required disabled onchange="checkOtherPlace()">
                            <option value="" disabled selected>Select District First</option>
                        </select>

                        <!-- Hidden input for custom place -->
                        <div id="otherPlaceContainer" style="display:none; margin-top:10px;">
                            <label>Enter the Other Place:<span class="required">*</span></label>
                            <input type="text" id="otherPlaceInput" placeholder="Enter your place name here" />
                        </div>
                    </div>

                    <div class="nav-row">
                        <button type="button" class="icon-btn" onclick="pressThenPrev(this,0)">
                            <i class="fa-solid fa-arrow-left"></i>
                        </button>
                        <button type="button" class="icon-btn" onclick="pressThenNext(this,2)">
                            <i class="fa-solid fa-arrow-right"></i>
                        </button>
                    </div>
                </form>


                <!-- Step 3 -->
                <form id="step3">
                    <div>
                        <h2>Payment Details üí≥</h2>

                        <div class="fee-display">
                            <div class="label">Total Registration Fee</div>
                            <div class="amount" id="feeAmount">‚Çπ0</div>
                        </div>

                        <div class="info-box">
                            <strong>üì± Payment Information</strong>
                            <p>Must Transfer 50% of the above amount to:<br>
                                <strong>Phone:</strong> 8341545549
                                <button type="button" class="copy-btn" onclick="copyPhoneNumber()">
                                    <i class="fa-solid fa-copy"></i> Copy
                                </button><br>
                                <strong>Name:</strong> DOKKA CHANDU BABU
                            </p>
                        </div>

                        <div class="pay-methods">
                            <button type="button" class="pay-btn" onclick="openPaymentApp('phonepe')">
                                <img src="https://uxwing.com/wp-content/themes/uxwing/download/brands-and-social-media/phonepe-icon.png"
                                    alt="PhonePe" width="100">
                            </button>


                            <button type="button" class="pay-btn" onclick="openPaymentApp('googlepay')">
                                <img src="https://uxwing.com/wp-content/themes/uxwing/download/brands-and-social-media/google-pay-icon.png"
                                    alt="Google Pay" width="100">
                            </button>

                            <!-- <button type="button" class="pay-btn" onclick="openPaymentApp('paytm')">
                <img src="https://uxwing.com/wp-content/themes/uxwing/download/brands-and-social-media/paytm-icon.png"
                  alt="Paytm" width="100">
              </button> -->

                            <button type="button" class="pay-btn" onclick="openPaymentApp('qr')">
                                <img src="https://uesiap.github.io/assets/cc-spicon-2026-upi-payment-small.jpg"
                                    alt="QR Code" width="130">
                            </button>
                        </div>

                        <label>Date & Time of Payment<span class="required">*</span></label>
                        <input type="datetime-local" id="dateOfPayment" required />

                        <label>Transaction ID<span class="required">*</span></label>
                        <small style="display:block; color: red; font-size:0.95rem; margin-bottom:6px;">
                            Enter last 6 digits of transaction ID
                        </small>
                        <small style="display:block; color: var(--brand); font-size:0.95rem; margin-bottom:6px;">
                            Enter last 6 digits of UTR Number (if done through Phonepe)
                        </small>

                        <input type="text" id="transactionId" name="transactionId"
                            placeholder="Enter last 6 digits of Transaction ID" required pattern="[A-Za-z0-9]{6,}"
                            title="Please enter at least 6 digits." />

                        <label>Amount Paid in Advance<span class="required">*</span></label>
                        <input type="number" id="amountPaid" placeholder="Enter amount you paid" required />

                        <label id="needToPayLabel" style="display:none; margin-top:6px;">Need to Pay at venue:</label>
                        <input type="number" id="needToPay" placeholder="Auto-calculates" readonly
                            style="display:none; background:#f3f4f6; font-weight:700;" />

                        <hr>

                        <label>Access Code<span class="required">*</span></label>
                        <small style="display:block; color:red; font-size:0.95rem; margin-bottom:6px;">
                            This code is required for authorized submission.
                        </small>
                        <input type="text" id="accessCode" placeholder="Enter your access code" required />
                    </div>
                    <div class="nav-row">
                        <button type="button" class="icon-btn" onclick="pressThenPrev(this,1)">
                            <i class="fa-solid fa-arrow-left"></i>
                        </button>
                        <button type="submit" class="btnn">Submit</button>
                    </div>
                </form>

            </span>

            <!-- Success Message -->
            <div id="successMessage">
                <div class="success-message-container">
                    <svg class="success-icon" viewBox="0 0 100 100">
                        <circle cx="50" cy="50" r="45" />
                        <path d="M30 52 L45 67 L75 37" />
                    </svg>
                    <h1>Successful Submission! üéâ </h1>
                    <p style="font-weight: bold">üôè Thank you for Registering.</p><br>
                    <p>Your response has been submitted successfully. ü§ù</p>
                    <hr>
                    <p style="font-size: bold; margin-bottom: 10px; text-align:center;">
                        Please Join, Spicon Whatsapp Group
                    </p>

                    <div style="display:flex; justify-content:center; gap:20px; margin-top:10px;">
                        <a class="success-wa-btn" href="https://chat.whatsapp.com/BaIpYoCrKXSFqBFolxkC18"
                            target="_blank"
                            style="text-decoration:none; color:var(--brand); font-weight:bold; border:1.5px solid var(--brand-dark); border-radius:5px; padding:5px; display:flex; align-items:center;">
                            <img src="https://uxwing.com/wp-content/themes/uxwing/download/brands-and-social-media/whatsapp-color-icon.png"
                                alt="Whatsapp" width="20" style="margin-right:6px;">
                            Join Spicon Group
                        </a>

                        <button type="button" class="pay-btn"
                            onclick="showWAQRPreview('https://uesiap.github.io/assets/cc-spicon-2026-wa-qr.jpg')">
                            <img src="https://uxwing.com/wp-content/themes/uxwing/download/computers-mobile-hardware/qr-code-icon.png"
                                alt="QR Code" width="130">
                        </button>
                    </div>

                </div>
            </div>
        </div>
    </main><br>

    <!-- Confirmation Dialog -->
    <div class="modal fade" id="confirmDialog" tabindex="-1" aria-labelledby="confirmDialogLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="confirmDialogLabel">
                        <i class="fas fa-exclamation-triangle text-warning"></i> Confirm Submission
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    ‚úåüèª Are you sure you want to submit the form?<br>This action cannot be undone.
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary"
                        style="border-radius:0;border:2px solid #ccc;background:transparent;color: black;" st
                        data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary"
                        style="border-radius:0;border:2px solid var(--brand);background:transparent;color: black;"
                        id="confirmSubmit">Confirm</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Loader -->
    <div id="loaderContainer">
        <div id="loader">
            <div class="spinner">
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
            </div>
            <p style="margin-left: 15px;">Submitting...</p>
        </div>
    </div>


    <footer>¬© Designed for ‚ù§Ô∏è <strong>Spicon 2026</strong></footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>

        const deadline = new Date("2025-12-27T23:59:59");
        const now = new Date();

        if (now > deadline) {
            document.getElementById("heaf").style.display = "none";
            document.getElementById("headf").style.display = "block";
            document.getElementById("eligibulity").style.display = "none";
            document.getElementById("close-category").style.display = "none";
            document.getElementById("open-registrer-info").style.display = "none";
            document.getElementById("closed-registrer-info").style.display = "block";
        }

        const firebaseConfig = {
            apiKey: "AIzaSyAaQdWKBdtqqe3pu9XDdPoFuvcEm2YG_wA",
            authDomain: "melam-rahul.firebaseapp.com",
            projectId: "melam-rahul",
        };

        document.addEventListener("DOMContentLoaded", () => {
            updatePageVisit("subFolders");
        });

        // Update page visit count
        function updatePageVisit(pagePath) {
            const now = new Date();
            const formattedDate = `${String(now.getDate()).padStart(2, "0")}/${String(now.getMonth() + 1).padStart(2, "0")}/${now.getFullYear()}`;
            const totalVisitsRef = database.ref(`AMSVisitorsLog/${pagePath}/${formattedDate}/TotalVisits`);

            totalVisitsRef.transaction((currentValue) => (currentValue || 0) + 1);
        }

        // Initialize Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // Restrict alphabetic-only fields (Full Name, Spouse Name, etc.) - now allows periods, apostrophes, hyphens
        document.querySelectorAll('#fullName, #spouseName, #recommendName').forEach(field => {
            field.addEventListener('input', () => {
                field.value = field.value.replace(/[^A-Za-z\s.'-]/g, '');
            });
        });

        // Allow only digits for phone numbers
        document.querySelectorAll('#contact, #recommendContact').forEach(field => {
            field.addEventListener('input', () => {
                field.value = field.value.replace(/[^0-9]/g, '');
            });
        });

        // Validate phone number length dynamically
        document.querySelectorAll('#contact, #recommendContact').forEach(field => {
            field.addEventListener('blur', () => {
                if (field.value.length !== 10) {
                    showDialog('üì± Invalid Number', 'Please enter a valid 10-digit phone number.');
                    field.focus();
                }
            });
        });




        // Validate Transaction ID (must be alphanumeric, at least 6 chars)
        const transactionField = document.getElementById('transactionId');
        transactionField.addEventListener('blur', () => {
            const value = transactionField.value.trim();
            if (value && !/^[A-Za-z0-9]{6,}$/.test(value)) {
                showDialog('üí≥ Invalid Transaction ID', 'Transaction ID should be at least 6 alphanumeric characters.');
                transactionField.focus();
            }
        });

        // Dialog 1 ‚Äî For Invalid Transaction
        function showDialog(title, message) {
            document.getElementById('dialogTitle').textContent = title;
            document.getElementById('dialogMessage').textContent = message;
            document.getElementById('customDialog').style.display = 'flex';
        }

        function closeDialog() {
            document.getElementById('customDialog').style.display = 'none'; // ‚úÖ fixed ID
        }

        // Dialog 2 ‚Äî For Payment Confirmation
        let pendingUrl = ''; // store redirect URL

        function showDialogg(title, message) {
            document.getElementById('dialogTitlee').textContent = title;
            document.getElementById('dialogMessagee').innerHTML = message;
            document.getElementById('customDialogg').style.display = 'flex';

            const okButton = document.getElementById('dialogOkButton');
            okButton.onclick = () => {
                closeDialogg();

                if (pendingQR) {
                    // open QR preview modal instead of redirect
                    showQRPreview(pendingQR);
                    return;
                }

                // normal redirect for UPI apps
                if (pendingUrl) {
                    window.location.href = pendingUrl;
                }
            };
        }

        function closeDialogg() {
            document.getElementById('customDialogg').style.display = 'none';
        }

        function showQRPreview(src) {
            const modal = document.getElementById('qrPreviewModal');
            const img = document.getElementById('qrPreviewImage');
            img.src = src;
            modal.style.display = 'flex';
        }

        function showWAQRPreview(src) {
            const modal = document.getElementById('waQRModal');
            const img = document.getElementById('waQRCodeImage');
            img.src = src;
            modal.style.display = 'flex';
        }

        function closeQRPreview() {
            document.getElementById('qrPreviewModal').style.display = 'none';
        }

        function closeWAQR() {
            document.getElementById('waQRModal').style.display = 'none';
        }

        document.getElementById("childrenCount").addEventListener("change", function () {
            const count = parseInt(this.value);
            const container = document.getElementById("childrenFields");

            container.innerHTML = ""; // reset

            for (let i = 1; i <= count; i++) {
                const wrapper = document.createElement("div");
                wrapper.className = "child-field";

                wrapper.innerHTML = `
            <label>Child ${i} (Name, Age & Gender) (12 - 15 Yrs only)</label>
            <input type="text" id="child${i}" placeholder="e.g. Joseph - 14 - Male" required />`;
                container.appendChild(wrapper);
            }

            updateFeeDisplay();
        });


        const steps = Array.from(document.querySelectorAll('.step'));
        const forms = ['step1', 'step2', 'step3'].map(id => document.getElementById(id));
        const progressWrap = document.getElementById('progressWrap');

        const places = {
            NTR: ['Jaggayyapeta', 'Kanchikacherla', 'Nandigama', 'Ibrahimpatnam', 'Mylavaram', 'Tiruvuru', 'Vissannapeta', 'Gollapudi', 'VJA West Zone', 'VJA Moghalrajpuram Zone', 'VJA Ramavarapadu Zone', 'VJA Benz Circle Zone', 'Other place'],
            Guntur: ['Tenali', 'Duggirala', 'Ponnuru', 'Guntur Central Zone', 'Guntur Chuttugunta Zone', 'Guntur North Zone', 'ANU', 'Mangalagiri', 'Tadepalli', 'Thullur', 'Other place'],
            Palnadu: ['Narasaraopet SZ', 'Chilakaluripeta', 'Narasaraopet NZ', 'Vinukonda', 'Sattenapalli', 'Piduguralla', 'Dachepalli', 'Macherla', 'Krosur', 'Atchampet', 'Karempudi', 'Rentachintala', 'Nuzendla', 'Amaravathi', 'Bellam konda', 'Epur', 'V.P South', 'Other place']
        };


        const fees = {
            'Student': 700,
            'Single Unemployed': 800,
            'Single Employed': 1600,
            'Family': 2600,
            //'Both Employed Family': 3000,
            'Staff': 0,
            // 'Choir': 0, // to be updated
            'Volunteer': 100 // FREE
            //'Other': 500
        };

        function showForm(i) {
            forms.forEach((f, idx) => f.classList.toggle('active', idx === i));
            steps.forEach((s, idx) => s.classList.toggle('active', idx <= i));
            document.documentElement.style.setProperty('--progress', (i / (forms.length - 1)) * 100 + '%');

            if (i === 2) {
                updateFeeDisplay();
            }
        }

        function startFormInternal() {
            document.getElementById('intro').classList.remove('active');
            progressWrap.style.display = 'block';
            document.querySelector('.form-container').classList.add('show');
            showForm(0);

            setTimeout(() => {
                const headerHeight = document.querySelector('header').offsetHeight;
                const progressHeight = document.getElementById('progressWrap').offsetHeight;
                const totalOffset = headerHeight + progressHeight;

                window.scrollTo({
                    top: totalOffset - 400,
                    behavior: 'smooth'
                });
            }, 100);
        }

        function backToIntro() {
            document.getElementById('intro').classList.add('active');
            progressWrap.style.display = 'none';
            document.querySelector('.form-container').classList.remove('show');
            forms.forEach(f => f.classList.remove('active'));

            setTimeout(() => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }, 100);
        }

        function copyPhoneNumber() {
            navigator.clipboard.writeText('8341545549').then(() => {
                showDialog('üìã Copied', 'Phone number: 8341545549');
            }).catch(() => {
                showDialog('üìû Contact', 'Phone number: 8341545549');
            });
        }

        function openPaymentApp(app) {
            const totalFeeText = document.getElementById('feeAmount').textContent;
            const totalFee = parseFloat(totalFeeText.replace('‚Çπ', '').replace(',', ''));
            const amount = (totalFee * 0.5).toFixed(2);

            if (app === 'phonepe') {
                pendingUrl = 'https://phone.pe/home';
            } else if (app === 'googlepay') {
                pendingUrl = 'https://gpay.app.goo.gl/bjy4';
            } else if (app === 'paytm') {
                pendingUrl = 'https://m.p-y.tm/home';
            }

            // NEW: QR CASE ‚Üí no redirect, only show QR preview after dialog
            if (app === 'qr') {
                pendingUrl = null; // block redirect
                pendingQR = 'https://uesiap.github.io/assets/cc-spicon-2026-upi-payment-big.jpg';
            } else {
                pendingQR = null;
            }

            showDialogg(
                'üí∞ Make Payment',
                `Please pay ‚Çπ${amount}/ full amount to:<br><strong>8341545549</strong><br>(DOKKA CHANDU BABU)<br><br>Click OK to continue`
            );
        }

        function pressButtonVisual(el) {
            el.classList.add('pressed');
            setTimeout(() => el.classList.remove('pressed'), 250);
        }

        function pressThenStart(btn) {
            pressButtonVisual(btn);
            setTimeout(startFormInternal, 220);
        }

        function pressThenNext(btn, i) {
            pressButtonVisual(btn);

            const activeForm = document.querySelector('.form-container form.active');

            if (activeForm && !activeForm.checkValidity()) {
                activeForm.reportValidity();
                return;
            }

            // Additional validation for custom fields
            if (!validateCurrentStep(i - 1)) {
                return;
            }

            setTimeout(() => {
                showForm(i);

                setTimeout(() => {
                    const headerHeight = document.querySelector('header').offsetHeight;
                    const progressHeight = document.getElementById('progressWrap').offsetHeight;
                    const totalOffset = headerHeight + progressHeight;

                    window.scrollTo({
                        top: totalOffset - 400,
                        behavior: 'smooth'
                    });
                }, 100);
            }, 200);
        }

        function validateCurrentStep(stepIndex) {
            // Step 0 (Personal Details)
            if (stepIndex === 0) {
                const attendAs = document.getElementById('attendAs').value;

                // Check if "Other" is selected and text is provided
                if (attendAs === 'Other') {
                    const otherText = document.getElementById('otherText')?.value.trim();
                    if (!otherText) {
                        showDialog('‚ö† Required Field', 'Please specify your attendance type in "Other" field.');
                        document.getElementById('otherText').focus();
                        return false;
                    }
                }

                // Check family fields if applicable
                if (attendAs === 'Single Employed Family' || attendAs === 'Both Employed Family' || attendAs === 'Staff') {
                    const spouseName = document.getElementById('spouseName')?.value.trim();
                    if (!spouseName) {
                        showDialog('‚ö† Required Field', 'Please enter spouse name.');
                        document.getElementById('spouseName').focus();
                        return false;
                    }
                }
            }

            // Step 1 (Recommendation & Place)
            if (stepIndex === 1) {
                const place = document.getElementById('place').value;

                // Check if "Other" is selected and custom place is provided
                if (place === 'Other place') {
                    const otherPlace = document.getElementById('otherPlaceInput')?.value.trim();
                    if (!otherPlace) {
                        showDialog('‚ö† Required Field', 'Please enter your place name.');
                        document.getElementById('otherPlaceInput').focus();
                        return false;
                    }
                }
            }

            return true;
        }

        function pressThenPrev(btn, i) {
            pressButtonVisual(btn);
            setTimeout(() => {
                showForm(i);

                setTimeout(() => {
                    const headerHeight = document.querySelector('header').offsetHeight;
                    const progressHeight = document.getElementById('progressWrap').offsetHeight;
                    const totalOffset = headerHeight + progressHeight;

                    window.scrollTo({
                        top: totalOffset - 400,
                        behavior: 'smooth'
                    });
                }, 100);
            }, 180);
        }

        function pressThenGo(el, i) {
            el.classList.add('pressed');

            setTimeout(() => {
                el.classList.remove('pressed');
                showForm(i);

                setTimeout(() => {
                    const headerHeight = document.querySelector('header').offsetHeight;
                    const progressHeight = document.getElementById('progressWrap').offsetHeight;
                    const totalOffset = headerHeight + progressHeight;

                    window.scrollTo({
                        top: totalOffset - 300,
                        behavior: 'smooth'
                    });
                }, 100);
            }, 180);
        }

        function updateAttendeeType() {
            const attendAs = document.getElementById('attendAs').value;
            const familyFields = document.getElementById('familyFields');
            const otherSpecify = document.getElementById('otherSpecify');

            // Handle family fields
            if (attendAs === 'Family' || attendAs === 'Both Employed Family' || attendAs === 'Staff') {
                familyFields.classList.add('show');
                document.getElementById('spouseName').setAttribute('required', 'required');
            } else {
                familyFields.classList.remove('show');
                document.getElementById('spouseName').removeAttribute('required');
            }

            // Handle "Other" specify field
            if (attendAs === 'Other') {
                otherSpecify.style.display = 'block';
                document.getElementById('otherText').setAttribute('required', 'required');
            } else {
                otherSpecify.style.display = 'none';
                document.getElementById('otherText').removeAttribute('required');
            }

            // Auto-set transaction ID for Volunteers
            if (attendAs === 'Staff') {
                document.getElementById('transactionId').value = '000000';
                document.getElementById('amountPaid').value = '0';
            }
        }

        function updatePlaces() {
            const districtSelect = document.getElementById('district');
            const district = districtSelect.value;
            const placeSelect = document.getElementById('place');
            const otherPlaceContainer = document.getElementById('otherPlaceContainer');
            const otherDistrictContainer = document.getElementById('otherDistrictContainer');
            const otherDistrictInput = document.getElementById('otherDistrictInput');
            const otherPlaceInput = document.getElementById('otherPlaceInput');

            // Reset all dynamic elements
            placeSelect.innerHTML = '<option value="" disabled selected>Select Place</option>';
            otherPlaceContainer.style.display = 'none';
            otherPlaceInput.value = '';
            otherPlaceInput.removeAttribute('required');
            otherDistrictContainer.style.display = 'none';
            otherDistrictInput.value = '';
            otherDistrictInput.removeAttribute('required');

            // If user selects "Other District"
            if (district === 'Other District') {
                // Show the "Enter Other District" input
                otherDistrictContainer.style.display = 'block';
                otherDistrictInput.setAttribute('required', 'required');

                // Auto-select "Other place" behavior
                placeSelect.disabled = false; // enable dropdown
                placeSelect.innerHTML = '<option value="Other place" selected>Other place</option>';

                // Show "Other Place" input automatically
                otherPlaceContainer.style.display = 'block';
                otherPlaceInput.setAttribute('required', 'required');
                return;
            }

            // Populate normal place options for known districts
            if (district && places[district]) {
                placeSelect.disabled = false;
                places[district].forEach(place => {
                    const option = document.createElement('option');
                    option.value = place;
                    option.textContent = place;
                    placeSelect.appendChild(option);
                });
            } else {
                placeSelect.disabled = true;
            }
        }

        function checkOtherPlace() {
            const placeSelect = document.getElementById('place');
            const otherPlaceContainer = document.getElementById('otherPlaceContainer');
            const otherPlaceInput = document.getElementById('otherPlaceInput');

            if (placeSelect.value === 'Other place') {
                otherPlaceContainer.style.display = 'block';
                otherPlaceInput.setAttribute('required', 'required');
            } else {
                otherPlaceContainer.style.display = 'none';
                otherPlaceInput.removeAttribute('required');
                otherPlaceInput.value = '';
            }
        }

        // ‚úÖ Use this when submitting or moving to next step
        function getLocationDetails() {
            const districtSelect = document.getElementById('district');
            const placeSelect = document.getElementById('place');
            const otherDistrictInput = document.getElementById('otherDistrictInput');
            const otherPlaceInput = document.getElementById('otherPlaceInput');

            let finalDistrict = districtSelect.value;
            let finalPlace = placeSelect.value;

            // If "Other District" selected, take custom district name
            if (finalDistrict === 'Other District') {
                finalDistrict = otherDistrictInput.value.trim();
            }

            // If "Other place" selected, take custom place name
            if (finalPlace === 'Other place') {
                finalPlace = otherPlaceInput.value.trim();
            }

            return { district: finalDistrict, place: finalPlace };
        }


        function updateFeeDisplay() {
            const attendAs = document.getElementById('attendAs').value;
            const children = parseInt(document.getElementById('childrenCount')?.value || 0);

            let baseFee = fees[attendAs] || 0;
            let childrenFee = children * 500;
            let totalFee = baseFee + childrenFee;

            if (attendAs === 'Volunteer') {
                const transactionField = document.getElementById('transactionId');
                const amountField = document.getElementById('amountPaid');
                transactionField.value = '000000';  // keep as string
                transactionField.setAttribute('type', 'text');  // force string input
                amountField.value = '0';
            } else {
                document.getElementById('transactionId').setAttribute('type', 'text');
            }

            document.getElementById('feeAmount').textContent = '‚Çπ' + totalFee.toLocaleString('en-IN');
        }

        document.getElementById("amountPaid").addEventListener("input", calculateNeedToPay);

        function calculateNeedToPay() {
            const totalFeeText = document.getElementById("feeAmount").textContent;
            const totalAmount = parseInt(totalFeeText.replace("‚Çπ", "").replace(",", "").trim()) || 0;
            const paidAmount = parseInt(document.getElementById("amountPaid").value) || 0;

            const balance = totalAmount - paidAmount; // negative means extra gift

            const label = document.getElementById("needToPayLabel");
            const field = document.getElementById("needToPay");

            label.style.display = "block";
            field.style.display = "block";

            field.value = balance;

            if (balance < 0) {
                label.textContent = "Giving Extra Gift for Spicon 2026 Need";
                field.style.color = "green";
            } else {
                label.textContent = "Need to Pay at venue:";
                field.style.color = "#111";
            }
        }

        document.getElementById('step3').addEventListener('submit', e => {
            e.preventDefault();

            const form = e.target;
            const submitBtn = form.querySelector('.btnn');

            // ‚úÖ Clear any previous red highlights
            document.querySelectorAll('.error-field').forEach(el => {
                el.classList.remove('error-field');
            });

            // ‚úÖ Validate all steps (step1, step2, step3)
            for (let i = 0; i < forms.length; i++) {
                const stepForm = forms[i];

                if (!stepForm.checkValidity()) {
                    const firstInvalid = stepForm.querySelector(':invalid');
                    if (firstInvalid) {
                        firstInvalid.classList.add('error-field');
                        showForm(i);
                        setTimeout(() => {
                            const yOffset = firstInvalid.getBoundingClientRect().top + window.pageYOffset - 400;
                            window.scrollTo({ top: yOffset, behavior: 'smooth' });
                            firstInvalid.focus({ preventScroll: true });
                        }, 300);
                    }
                    stepForm.reportValidity();
                    return;
                }

                if (!validateCurrentStep(i)) {
                    const invalid = stepForm.querySelector('.error-field') || stepForm.querySelector(':invalid');
                    if (invalid) {
                        showForm(i);
                        setTimeout(() => {
                            const yOffset = invalid.getBoundingClientRect().top + window.pageYOffset - 400;
                            window.scrollTo({ top: yOffset, behavior: 'smooth' });
                            invalid.focus({ preventScroll: true });
                        }, 300);
                    }
                    return;
                }

            }

            // ‚úÖ Final validation for volunteers and transaction ID
            const attendAs = document.getElementById('attendAs').value;
            const transactionId = document.getElementById('transactionId').value;

            if (attendAs === 'Volunteer' && transactionId !== '000000') {
                showDialog('‚ö† Volunteers', 'Volunteers should use Transaction ID: 000000');
                const field = document.getElementById('transactionId');
                field.classList.add('error-field');
                field.scrollIntoView({ behavior: 'smooth', block: 'center' });
                field.focus();
                return;
            }

            if (attendAs !== 'Volunteer' && transactionId === '000000') {
                showDialog('‚ö† Invalid Transaction ID', 'Transaction ID 000000 is reserved for Volunteers only.');
                const field = document.getElementById('transactionId');
                field.classList.add('error-field');
                field.scrollIntoView({ behavior: 'smooth', block: 'center' });
                field.focus();
                return;
            }

            // ‚úÖ Validate Access Code before allowing submission
            const accessCodeInput = document.getElementById('accessCode');
            const enteredCode = accessCodeInput.value.trim();

            // Set your actual valid code(s) here ‚Äî can be one or more
            const validAccessCodes = ['CCSPI26', 'ccspi26', 'Ccspi26'];

            if (!validAccessCodes.includes(enteredCode)) {
                showDialog('üîí Invalid Access Code', 'Please ask your Senior Advisor/EGF Secretary/EGF Persident/ RC/ DC/ Staff for this code.');
                accessCodeInput.classList.add('error-field');
                accessCodeInput.scrollIntoView({ behavior: 'smooth', block: 'center' });
                accessCodeInput.focus();
                return;
            }


            // ‚úÖ Everything valid ‚Äî show confirmation dialog
            const { district, place } = getLocationDetails();
            pressButtonVisual(submitBtn);

            const confirmationDialog = new bootstrap.Modal(document.getElementById('confirmDialog'));
            confirmationDialog.show();

            const confirmButton = document.getElementById('confirmSubmit');
            confirmButton.onclick = () => {
                confirmationDialog.hide();
                document.getElementById('loaderContainer').style.display = 'block';

                const formData = new FormData();

                formData.append("Full Name", document.getElementById("fullName").value);
                formData.append("Contact Number", document.getElementById("contact").value);
                formData.append("Gender", document.getElementById("gender").value);
                formData.append("Attend As", document.getElementById("attendAs").value);
                formData.append("Other Specify", document.getElementById("otherText")?.value || "");
                formData.append("Spouse Name", document.getElementById("spouseName")?.value || "");

                const kiddosCount = parseInt(document.getElementById("kiddosCount")?.value || "0");
                formData.append("Child (below 12 Yrs)", kiddosCount);

                // NEW: number of children
                const childCount = parseInt(document.getElementById("childrenCount")?.value || "0");
                formData.append("Child (12-15 Yrs)", childCount);

                // NEW: Append each child entry (Name + Age in one field)
                for (let i = 1; i <= childCount; i++) {
                    const childValue = document.getElementById(`child${i}`).value.trim();
                    formData.append(`Child ${i}`, childValue);
                }

                formData.append("Recommended By (Name)", document.getElementById("recommendName").value);
                formData.append("Recommended By (Role)", document.getElementById("recommendRole").value);
                formData.append("Recommended Contact", document.getElementById("recommendContact").value);
                formData.append("District", district);
                formData.append("Place", place);
                formData.append("Payment Date", document.getElementById("dateOfPayment").value);
                formData.append("Transaction ID", document.getElementById("transactionId").value);
                formData.append(
                    "Total Fee",
                    document.getElementById("feeAmount").textContent.replace("‚Çπ", "").replace(",", "").trim()
                );
                formData.append("Amount Paid", document.getElementById("amountPaid").value);
                formData.append("Need to Pay", document.getElementById("needToPay").value || "0");

                fetch("https://script.google.com/macros/s/AKfycbxfvG-BIPcxulOgSgkRXcPxESWSZllqxI1ATsvzArPip2ego1skCRwfxytyD9W07xw/exec", {
                    method: "POST",
                    body: formData
                })
                    .then(response => response.json())
                    .then(result => {
                        document.getElementById('loaderContainer').style.display = 'none';

                        if (result.result === "submission_cached" || result.result === "email_batch_sent" || result.result === "success") {
                            document.getElementById('steps-container').style.display = 'none';
                            document.querySelector('.form-container').style.marginTop = '4rem 0 0 0';
                            document.getElementById('successMessage').style.display = 'block';
                            document.getElementById('progressWrap').style.display = 'none';
                            document.querySelector('.success-message-container').style.display = 'block';
                        } else {
                            showDialog("‚ö† Error", "Something went wrong: " + (result.message || "No confirmation received."));
                        }
                    })
                    .catch(error => {
                        console.error("Error submitting the form:", error);
                        document.getElementById('loaderContainer').style.display = 'none';
                        showDialog("‚ùå Error", "Could not connect to the server. Please try again.");
                    });
            };

        });

        forms.forEach(f => f.classList.remove('active'));
    </script>
</body>

</html>
